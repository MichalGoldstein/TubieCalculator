<!DOCTYPE html>
<html lang="en">
<head>
    <script
    type="text/javascript"
    src="https://app.termly.io/resource-blocker/d8fe3189-bcd8-4f8c-a80d-e57c7ac78811?autoBlock=on"
    ></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9402124382820996"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tube Feeding Calculator</title>
    <link rel="icon" href="favicon.png" type="image/png">  
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&family=Open+Sans&display=swap" rel="stylesheet">
</head>
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            margin: 20px;
            line-height: 1.6;
            background-color: #EFFAFD;
            color: #37474f;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 900px;
            padding: 30px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: inline-block;
            vertical-align: middle;
            width: 100px; /* Adjust logo size */
            height: auto;
            margin-right: 150px; /* Space between logo and title */
            margin-bottom: 50px;
        }

        h1, h2 {
            font-family: 'Nunito', sans-serif;
            color: #4A8BDF; /* Royal blue headings */
            text-align: center;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333; /* Dark gray labels */
        }

        .title {
            display: inline-block;
            vertical-align: middle;
            justify-content: center;
            align-items: center;
        }

        select, input, button {
            width: calc(100% - 16px);
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }

        button {
            background-color: #A0006D; /* Eggplant buttons */
            border: none;
            color: white;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #88005b; /* Darker eggplant on hover */
        }

        .output-box {
            display: inline-block;
            padding: 5px 10px;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-left: 5px;
            min-width: 50px;
            text-align: center;
        }

        .columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .column {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background-color: white; /* White column backgrounds */
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .disclaimer {
            margin-top: 30px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #fff9c4;
            border: none;
            border-radius: 10px;
            font-size: 0.9em;
            color: #555;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .disclaimer strong {
            color: #d9534f;
        }

        .not-available { /* Style for "N/A" messages */
            font-style: italic;
            color: gray;
            margin-top: 5px; /* Add some spacing */
            text-align: center;
        }

        nav {
            text-align: center;
            margin-bottom: 20px;
            background-color: #4A8BDF;
            padding: 10px 0;
            border-radius: 5px;
        }

        nav a {
            margin: 0 10px;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: #3f74b1;
        }
        footer {
        background-color: #f0f0f0; /* Match your site's lighter beige background */
        padding: 20px;
        text-align: center;
        font-size: 0.9em;
        border-top: 1px solid #ddd;
        }

        .footer-content {
        max-width: 800px;
        margin: 0 auto;
        }

        .footer-links a {
        color: #333; /* Adjust for good contrast */
        text-decoration: none;
        margin: 0 5px;
        }

        .footer-links a:hover {
        text-decoration: underline;
        }

    </style>
</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact Us</a>
    </nav>
    <main>
    <div class="container">
        <img src="favicon_enhanced.png" alt="Logo" class="logo">
        <span class="title"><h1>Tube Feeding Calculator</h1></span>

        <div class="input-group">
            <label for="brandSelect">Choose a brand:</label>
            <select id="brandSelect">
                <option value="" selected disabled>Select a brand</option>
            </select>
        </div>
        <div class="input-group">
            <label for="formulaSelect">Choose a formula:</label>
            <select id="formulaSelect" disabled>
                <option value="" selected disabled>Select a formula</option>
            </select>
        </div>


        <div class="columns">
            <div class="column">
                <h2>Calorie Calculations</h2>
                <div class="input-group">
                    <label for="calorieContent">Calorie Content:</label>
                    <span id="calorieContent" class="output-box"></span> kcal/ml
                </div>
                <div class="input-group">
                    <label for="calorieGoal">Enter your calorie goal:</label>
                    <input type="number" id="calorieGoal" placeholder="Calorie goal in kcal">
                </div>
                <button id="calculateVolumeBtn">Calculate Volume</button>
                <div class="input-group">
                    <label for="volumeRequired">Volume Required:</label>
                    <span id="volumeRequired" class="output-box"></span> ml
                </div>
                <div class="input-group">
                    <label for="infusionHours">Enter hours to infuse:</label>
                    <input type="number" id="infusionHours" placeholder="Infusion hours">
                </div>
                <button id="calculateRateBtn">Calculate Rate</button>
                <div class="input-group">
                    <label for="rateRequired">Rate Required:</label>
                    <span id="rateRequired" class="output-box"></span> ml/hr
                </div>
            </div>

            <div class="column">
                <h2>Water Calculations</h2>
                <div class="input-group">
                    <label for="waterContent100">Water Content (per 100ml):</label>
                    <span id="waterContent100" class="output-box"></span> ml
                </div>
                <div class="input-group">
                    <label for="waterContentCalculated">Water Content (in calculated volume):</label>
                    <span id="waterContentCalculated" class="output-box"></span> ml
                </div>
                <div class="input-group">
                    <label for="waterGoal">Enter your water goal:</label>
                    <input type="number" id="waterGoal" placeholder="Water goal in ml">
                </div>
                <button id="calculateWaterToAddBtn">Calculate Water to Add</button>
                <div class="input-group">
                    <label for="waterToAdd">Water to Add:</label>
                    <span id="waterToAdd" class="output-box"></span> ml
                </div>
                <div class="input-group">
                    <label for="updatedRate">Updated Rate (with added water):</label>
                    <span id="updatedRate" class="output-box"></span> ml/hr
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <p><strong>Disclaimer:</strong> The information provided on this website is for general informational purposes only. It is not intended as medical advice or to replace consultation with your healthcare provider. Always consult with your medical team before making any decisions regarding your healthcare or nutrition needs.</p>
        </div>
        <footer>
            <div class="footer-content">
              <p>&copy; 2025 Tubie Calculator. All rights reserved.</p>
              <div class="footer-links">
                <a href="privacy.html">Privacy Policy</a> | 
                <a href="terms.html">Terms of Service</a> | 
                <a href="#" class="termly-display-preferences">Consent Preferences</a>
              </div>
            </div>
          </footer>

    </div>
    </main>

    <script>
        let data = {};
        let waterData = {};

        fetch('data.json')
            .then(response => response.json())
            .then(json => {
                data = json;
                populateBrands();
                fetch('water.json')
                    .then(response => response.json())
                    .then(json => {
                        waterData = json;
                    })
                    .catch(err => console.error('Error loading water.json:', err));
            })
            .catch(err => console.error('Error loading data.json:', err));

        const brandSelect = document.getElementById('brandSelect');
        const formulaSelect = document.getElementById('formulaSelect');
        const calorieContent = document.getElementById('calorieContent');
        const volumeRequired = document.getElementById('volumeRequired');
        const rateRequired = document.getElementById('rateRequired');
        const waterContent100Element = document.getElementById('waterContent100');
        const waterContentCalculatedElement = document.getElementById('waterContentCalculated');
        const waterToAddElement = document.getElementById('waterToAdd');
        const updatedRateElement = document.getElementById('updatedRate');
        const outputBoxes = [calorieContent, volumeRequired, rateRequired, waterContent100Element, waterContentCalculatedElement, waterToAddElement, updatedRateElement];
        outputBoxes.forEach(box => box.textContent = "");

        function populateBrands() {
            Object.keys(data).forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
        }

        brandSelect.addEventListener('change', () => {
            formulaSelect.innerHTML = '<option value="" selected disabled>Select a formula</option>';
            formulaSelect.disabled = false;

            const selectedBrand = brandSelect.value;
            const formulas = data[selectedBrand];

            Object.keys(formulas).sort().forEach(formula => {
                const option = document.createElement('option');
                // The problem was here: you were setting the value to the calorie content
                // It should be the formula Name itself
                option.value = formula; // Correct: set value to the formula name (key)
                option.textContent = formula; // Text content should also be the formula name
                formulaSelect.appendChild(option);
            });
        });

        formulaSelect.addEventListener('change', () => {
            const selectedBrand = brandSelect.value;
            const selectedFormula = formulaSelect.value;

            const calorieContentValue = data[selectedBrand][selectedFormula];
            let waterContentValue = waterData[selectedBrand][selectedFormula];

            updateOutput(calorieContent, calorieContentValue);
            updateOutput(waterContent100Element, waterContentValue); // Update water content output here

            const waterContent100Container = waterContent100Element.parentNode;
            let notAvailableMessage = waterContent100Container.querySelector('.not-available');

            if (waterContentValue === "N/A") {
                updateOutput(waterContent100Element, "");

                if (!notAvailableMessage) {
                    notAvailableMessage = document.createElement('div');
                    notAvailableMessage.className = 'not-available';
                    waterContent100Container.appendChild(notAvailableMessage);
                }
                notAvailableMessage.textContent = 'Water content not available for this formula.';
                waterContentValue = 0;
            } else {
                if (notAvailableMessage && notAvailableMessage.textContent === 'Water content not available for this formula.') {
                    waterContent100Container.removeChild(notAvailableMessage);
                }
            }
        });

        document.getElementById('calculateVolumeBtn').addEventListener('click', () => {
             const goal = parseFloat(document.getElementById('calorieGoal').value);
            const calPerMl = parseFloat(formulaSelect.value);
            const volume = goal / calPerMl;
            updateOutput(volumeRequired, volume);
            const waterPer100 = parseFloat(waterContent100Element.textContent) || 0;
            updateOutput(waterContentCalculatedElement, (volume / 100) * waterPer100);
        });

        document.getElementById('calculateRateBtn').addEventListener('click', () => {
           const hours = parseFloat(document.getElementById('infusionHours').value);
            const goal = parseFloat(document.getElementById('calorieGoal').value);
            const calPerMl = parseFloat(formulaSelect.value);
            const volume = goal / calPerMl;
            updateOutput(rateRequired, volume / hours);

            const waterToAdd = parseFloat(waterToAddElement.textContent) || 0;
            const totalVolume = volume + waterToAdd;
            const waterPer100 = parseFloat(waterContent100Element.textContent) || 0;
            updateOutput(waterContentCalculatedElement, (totalVolume/100)* waterPer100);
            updateOutput(updatedRateElement, totalVolume / hours);
        });

        document.getElementById('calculateWaterToAddBtn').addEventListener('click', () => {
            const waterGoal = parseFloat(document.getElementById('waterGoal').value);
            const waterContentPer100 = parseFloat(document.getElementById('waterContent100').textContent);
            const volumeRequiredValue = parseFloat(document.getElementById('volumeRequired').textContent);
            const infusionHours = parseFloat(document.getElementById('infusionHours').value);


            if (!isNaN(waterGoal) && !isNaN(waterContentPer100) && !isNaN(volumeRequiredValue) && !isNaN(infusionHours)) {
                let waterToAdd = Math.max(0, waterGoal - ((volumeRequiredValue * waterContentPer100) / 100));

                updateOutput(waterToAddElement, waterToAdd);

                // Correctly calculate updated rate.
                let updatedRate = volumeRequiredValue / infusionHours;
                if(waterToAdd > 0){
                    updatedRate = (volumeRequiredValue + waterToAdd) / infusionHours;
                }
                updateOutput(updatedRateElement, updatedRate);
            } else {
                updateOutput(waterToAddElement, NaN);
                updateOutput(updatedRateElement, NaN);
            }
        });

        function updateOutput(element, value) {
            element.textContent = value ? value.toFixed(2) : 0;
        }

    </script>
</body>
</html>